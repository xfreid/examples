/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */

class GreetingToFileTask extends DefaultTask {

    def destination

    @OutputFile
    File getDestination() {
        project.file(destination)
    }

    @TaskAction
    def greet() {
        def file = getDestination()
        file.parentFile.mkdirs()
        file.write 'Hello World!'
    }
}

task greet(type: GreetingToFileTask) {
    destination = { project.greetingFile }
}

// "sayGreeting" task depends on "greet" task
// greet task writes the gretting words to specified greetingFile
// sayGreeting reads the content of the grettingFile
task sayGreeting(dependsOn: greet) {
    doLast {
        println project.file(project.greetingFile).text
	// or simply
	// println file(greetingFile).text
    }
}

// add an extra property on Project
// consumer can reference this property by Project.greetingFile
ext.greetingFile = "$buildDir/hello.txt"

